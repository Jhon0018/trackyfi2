<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>TrackYfi - Tu Portafolio de Inversiones</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome para iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Estilos personalizados -->
    <link rel="stylesheet" href="home.css">
</head>
<body>
    <div class="floating-shapes">
        <div class="shape">
            <i class="fas fa-chart-line" style="font-size: 3rem; color: #000;"></i>
        </div>
        <div class="shape">
            <i class="fas fa-coins" style="font-size: 2.5rem; color: #000;"></i>
        </div>
        <div class="shape">
            <i class="fas fa-trending-up" style="font-size: 3.5rem; color: #000;"></i>
        </div>
    </div>

    <nav class="navbar navbar-expand-lg fixed-top">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-chart-pie me-2"></i>TrackYfi
            </a>
            <div class="navbar-nav ms-auto">
                <div id="authButtons">
                    <button class="btn btn-success me-2" id="loginBtn">Iniciar Sesión</button>
                    <button class="btn btn-custom" id="registerBtn">Registrarse</button>
                </div>
                <div id="userInfo" class="d-none">
                    <span class="navbar-text me-3" id="userEmail"></span>
                    <a href="home.html" class="btn btn-custom me-2" id="dashboardBtn">tu portafolio</a>
                    <button class="btn btn-outline-dark" id="logoutBtn">Cerrar Sesión</button>
                </div>
                <!-- Botón para cambiar modo blanco/negro -->
                <button class="btn btn-outline-dark ms-2" id="toggleThemeBtn" title="Cambiar modo blanco/negro">
                    <i class="fas fa-adjust"></i>
                </button>
                <!-- Botón para abrir el menú lateral -->
                <button class="btn btn-outline-dark ms-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#sideMenu" aria-controls="sideMenu" title="Menú">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Menú lateral derecho -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="sideMenu" aria-labelledby="sideMenuLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="sideMenuLabel">Menú</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Cerrar"></button>
  </div>
  <div class="offcanvas-body">
    <ul class="list-group list-group-flush">
      <li class="list-group-item bg-transparent"><a href="/" class="text-decoration-none text-dark">Inicio</a></li>
      <li class="list-group-item bg-transparent"><a href="/dashboard" class="text-decoration-none text-dark">Dashboard</a></li>
      <li class="list-group-item bg-transparent"><a href="#" class="text-decoration-none text-dark">Perfil</a></li>
      <li class="list-group-item bg-transparent"><a href="#" class="text-decoration-none text-dark">Configuración</a></li>
      <li class="list-group-item bg-transparent"><a href="#" class="text-decoration-none text-dark">Ayuda</a></li>
    </ul>
  </div>
</div>

    <!-- Sección Hero -->
    <section class="hero-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <h1 class="hero-title">Controla tus Inversiones con Inteligencia</h1>
                    <p class="hero-subtitle">
                        TrackYfi te permite monitorear y gestionar tu portafolio de inversiones en tiempo real. 
                        Acciones, criptomonedas y más, todo en un solo lugar.
                    </p>
                    <div class="d-flex gap-3 flex-wrap">
                        <button class="btn btn-custom btn-lg" id="getStartedBtn">
                            <i class="fas fa-rocket me-2"></i>Comenzar Ahora
                        </button>
                        <button class="btn btn-outline-light btn-lg">
                            <i class="fas fa-play me-2"></i>Ver Demo
                        </button>
                    </div>
                </div>
                <div class="col-lg-6 mt-5 mt-lg-0">
                    
                </div>
            </div>
        </div>
    </section>

    <!-- Sección de Estadísticas -->
    <section class="stats-section">
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <div class="stat-item">
                        <span class="stat-number">10K+</span>
                        <div class="stat-label">Usuarios Activos</div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="stat-item">
                        <span class="stat-number">$50M+</span>
                        <div class="stat-label">Capital Gestionado</div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="stat-item">
                        <span class="stat-number">99.9%</span>
                        <div class="stat-label">Tiempo de Actividad</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Sección de Características -->
    <section class="py-5">
        <div class="container">
            <div class="row text-center mb-5">
                <div class="col-12">
                    <h2 class="display-5 fw-bold mb-3" style="color:rgb(0, 0, 0);">¿Por qué elegir TrackYfi?</h2>
                    <p class="lead" style="color:rgb(0, 0, 0);">Potencia tu estrategia de inversión con nuestras herramientas avanzadas</p>
                </div>
            </div>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h3 class="feature-title">Seguimiento en Tiempo Real</h3>
                        <p class="feature-description">
                            Monitorea el rendimiento de tus inversiones con datos actualizados al minuto. 
                            Nunca pierdas una oportunidad del mercado.
                        </p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <h3 class="feature-title">Seguridad Avanzada</h3>
                        <p class="feature-description">
                            Tus datos están protegidos con encriptación de nivel bancario y autenticación 
                            de múltiples factores.
                        </p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-mobile-alt"></i>
                        </div>
                        <h3 class="feature-title">Multiplataforma</h3>
                        <p class="feature-description">
                            Accede a tu portafolio desde cualquier dispositivo. Diseño responsivo 
                            optimizado para móviles y tablets.
                        </p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-coins"></i>
                        </div>
                        <h3 class="feature-title">Multi-Activos</h3>
                        <p class="feature-description">
                            Gestiona acciones, criptomonedas, ETFs y más. Todo tu portafolio 
                            diversificado en una sola plataforma.
                        </p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-brain"></i>
                        </div>
                        <h3 class="feature-title">Analytics Inteligentes</h3>
                        <p class="feature-description">
                            Obtén insights profundos sobre tu portafolio con análisis automatizado 
                            y recomendaciones personalizadas.
                        </p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-bell"></i>
                        </div>
                        <h3 class="feature-title">Alertas Personalizadas</h3>
                        <p class="feature-description">
                            Configura alertas de precio, volumen y rendimiento. Mantente informado 
                            sin estar pegado a la pantalla.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Formulario de Login/Registro -->
    <section id="authSection" class="py-5 d-none">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-7">
                    <div class="login-form">
                        <h3 class="text-center mb-4" style="color:rgb(0, 0, 0);" id="authTitle">Iniciar Sesión</h3>
                        
                        <div id="alertContainer"></div>
                        
                        <form id="authForm">
                            <div class="mb-3">
                                <label for="email" class="form-label">Email</label>
                                <input type="email" class="form-control" id="email" required placeholder="tu@email.com">
                            </div>
                            <div class="mb-3">
                                <label for="password" class="form-label">Contraseña</label>
                                <input type="password" class="form-control" id="password" required placeholder="••••••••">
                            </div>
                            <div class="mb-3 d-none" id="extraFields">
                                <label for="country" class="form-label">País</label>
                                <input type="text" class="form-control" id="country" placeholder="Ej: Colombia">
                            </div>
                            <div class="mb-3 d-none" id="ageField">
                                <label for="age" class="form-label">Edad</label>
                                <input type="number" class="form-control" id="age" min="1" max="120" placeholder="Tu edad">
                            </div>
                            <button type="submit" class="btn btn-custom w-100 mb-3" id="authSubmitBtn">
                                Iniciar Sesión
                            </button>
                            <!-- Casilla solo visible en modo registro, centrada y abajo -->
                            <div class="d-none" id="termsContainer">
                                <div class="form-check d-flex justify-content-center">
                                    <input class="form-check-input me-2" type="checkbox" id="termsCheck">
                                    <label class="form-check-label small" for="termsCheck">
                                        Acepto los <a href="#" target="_blank" style="text-decoration: underline;">Términos y Condiciones</a>
                                    </label>
                                </div>
                            </div>
                            <div class="text-center mb-2 mt-3">
                                <button type="button" class="btn btn-link" id="forgotPasswordBtn" style="color: #3b82f6;">
                                    ¿Olvidaste tu contraseña?
                                </button>
                            </div>
                            <div class="text-center">
                                <button class="btn btn-link" id="toggleAuthBtn" style="color: #3b82f6;">
                                    ¿No tienes cuenta? Regístrate
                                </button>
                            </div>
                        </form>
                        
                        <!-- Botón de autenticación con Google -->
                        <button type="button" class="btn btn-outline-dark w-100 mb-3 d-flex align-items-center justify-content-center" id="googleAuthBtn">
    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google" style="width:24px; height:24px; margin-right:8px;">
    Continuar con Google
</button>

                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Sección CTA -->
    <section class="cta-section" id="ctaSection">
        <div class="container text-center">
            <h2 class="cta-title">¿Listo para optimizar tus inversiones?</h2>
            <p class="cta-subtitle">Únete a miles de inversionistas que ya confían en TrackYfi</p>
            <button class="btn btn-success btn-lg" id="startNowBtn">
                <i class="fas fa-arrow-right me-2"></i>Comenzar Gratis
            </button>
        </div>
    </section>

    <!-- Modal para restablecer contraseña -->
<div class="modal fade" id="resetPasswordModal" tabindex="-1" aria-labelledby="resetPasswordModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form id="resetPasswordForm">
        <div class="modal-header">
          <h5 class="modal-title" id="resetPasswordModalLabel">Restablecer contraseña</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label for="resetEmail" class="form-label">Correo electrónico</label>
            <input type="email" class="form-control" id="resetEmail" required placeholder="tu@email.com">
          </div>
          <div id="resetPasswordAlert"></div>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-success">Enviar enlace</button>
        </div>
      </form>
    </div>
  </div>
</div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Firebase SDK -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js';
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged, sendPasswordResetEmail, GoogleAuthProvider, signInWithPopup } from 'https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js';
        import { getAnalytics } from 'https://www.gstatic.com/firebasejs/9.6.1/firebase-analytics.js';
        import { getFirestore, doc, setDoc, getDoc } from 'https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js';

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBj0vG5CgWxEBrvkNBMvMU9TFcKuqLP0cc",
            authDomain: "trackyfi-317e1.firebaseapp.com",
            projectId: "trackyfi-317e1",
            storageBucket: "trackyfi-317e1.appspot.com",
            messagingSenderId: "843779589124",
            appId: "1:843779589124:web:d782b98668b1c16ce0a151",
            measurementId: "G-9DQCFXXND3"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const analytics = getAnalytics(app);
        const db = getFirestore(app);

        // Variables globales
        let isLoginMode = true;

        // Elementos del DOM
        const authButtons = document.getElementById('authButtons');
        const userInfo = document.getElementById('userInfo');
        const userEmail = document.getElementById('userEmail');
        const authSection = document.getElementById('authSection');
        const ctaSection = document.getElementById('ctaSection');
        const authForm = document.getElementById('authForm');
        const authTitle = document.getElementById('authTitle');
        const authSubmitBtn = document.getElementById('authSubmitBtn');
        const toggleAuthBtn = document.getElementById('toggleAuthBtn');
        const alertContainer = document.getElementById('alertContainer');

        // Funciones de utilidad
        function showAlert(message, type = 'danger') {
            alertContainer.innerHTML = `
                <div class="alert alert-${type} alert-dismissible fade show" role="alert">
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            `;
        }

        function toggleAuthMode() {
            isLoginMode = !isLoginMode;
            if (isLoginMode) {
                authTitle.textContent = 'Iniciar Sesión';
                authSubmitBtn.textContent = 'Iniciar Sesión';
                toggleAuthBtn.innerHTML = '¿No tienes cuenta? Regístrate';
                document.getElementById('termsContainer').classList.add('d-none');
                document.getElementById('extraFields').classList.add('d-none');
                document.getElementById('ageField').classList.add('d-none');
            } else {
                authTitle.textContent = 'Crear Cuenta';
                authSubmitBtn.textContent = 'Registrarse';
                toggleAuthBtn.innerHTML = '¿Ya tienes cuenta? Inicia sesión';
                document.getElementById('termsContainer').classList.remove('d-none');
                document.getElementById('extraFields').classList.remove('d-none');
                document.getElementById('ageField').classList.remove('d-none');
            }
            alertContainer.innerHTML = '';
        }

        function showAuthSection() {
            authSection.classList.remove('d-none');
            ctaSection.classList.add('d-none');
            authSection.scrollIntoView({ behavior: 'smooth' });
        }

        function hideAuthSection() {
            authSection.classList.add('d-none');
            ctaSection.classList.remove('d-none');
        }

        // Event listeners
        // Cuando se hace click en "Registrarse"
        document.getElementById('registerBtn').addEventListener('click', () => {
    isLoginMode = false;
    toggleAuthMode();
    showAuthSection();
});

        // Cuando se hace click en "Iniciar Sesión"
        document.getElementById('loginBtn').addEventListener('click', () => {
    isLoginMode = true;
    toggleAuthMode();
    showAuthSection();
});

        document.getElementById('getStartedBtn').addEventListener('click', () => {
            isLoginMode = false;
            toggleAuthMode();
            showAuthSection();
        });

        document.getElementById('startNowBtn').addEventListener('click', () => {
            isLoginMode = false;
            toggleAuthMode();
            showAuthSection();
        });

        toggleAuthBtn.addEventListener('click', toggleAuthMode);

        document.getElementById('logoutBtn').addEventListener('click', async () => {
            try {
                await signOut(auth);
                showAlert('Sesión cerrada exitosamente', 'success');
            } catch (error) {
                showAlert('Error al cerrar sesión: ' + error.message);
            }
        });

        document.getElementById('dashboardBtn').addEventListener('click', () => {
    window.location.href = 'index.html';
});

        // Manejo del formulario de autenticación
        authForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const country = document.getElementById('country').value;
            const age = document.getElementById('age').value;
            if (!isLoginMode) {
                const termsAccepted = document.getElementById('termsCheck').checked;
                if (!termsAccepted) {
                    showAlert('Debes aceptar los Términos y Condiciones para registrarte.');
                    return;
                }
                if (!country || !age) {
                    showAlert('Por favor completa todos los campos de registro.');
                    return;
                }
            }
            try {
                if (isLoginMode) {
                    await signInWithEmailAndPassword(auth, email, password);
                    // Después de autenticación exitosa con email/contraseña
                    showAlert('¡Inicio de sesión exitoso!', 'success');
                    authForm.reset();
                    hideAuthSection();
                    window.location.href = "home.html"; // <-- CAMBIA aquí a home.html
                } else {
                    const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                    const user = userCredential.user;
                    // Guarda los datos extra en Firestore
                    await setDoc(doc(db, "users", user.uid), {
                        email: user.email,
                        pais: country,
                        edad: age,
                        creado: new Date()
                    });
                    showAlert('¡Cuenta creada exitosamente!', 'success');
                }
                
                // Limpiar formulario
                authForm.reset();
                hideAuthSection();
                
            } catch (error) {
                let errorMessage = 'Error desconocido';
                
                switch (error.code) {
                    case 'auth/email-already-in-use':
                        errorMessage = 'Este email ya está registrado';
                        break;
                    case 'auth/weak-password':
                        errorMessage = 'La contraseña debe tener al menos 6 caracteres';
                        break;
                    case 'auth/invalid-email':
                        errorMessage = 'Email inválido';
                        break;
                    case 'auth/user-not-found':
                    case 'auth/wrong-password':
                        errorMessage = 'Datos incorrectos. Verifica tu email y contraseña.';
                        break;
                    default:
                        errorMessage = 'Ocurrió un error. Intenta nuevamente.';
                }
                
                showAlert(errorMessage);
            }
        });

        document.getElementById('forgotPasswordBtn').addEventListener('click', () => {
    // Limpia el formulario y alertas del modal
    document.getElementById('resetEmail').value = '';
    document.getElementById('resetPasswordAlert').innerHTML = '';
    // Abre el modal
    const modal = new bootstrap.Modal(document.getElementById('resetPasswordModal'));
    modal.show();
});

        document.getElementById('googleAuthBtn').addEventListener('click', async () => {
            const provider = new GoogleAuthProvider();
            try {
                const result = await signInWithPopup(auth, provider);
                const user = result.user;

                // Verifica si el usuario ya existe en Firestore
                const userRef = doc(db, "users", user.uid);
                const userSnap = await getDoc(userRef);

                if (!userSnap.exists()) {
                    // Si no existe, crea el documento del usuario
                    await setDoc(userRef, {
                        email: user.email,
                        nombre: user.displayName || "",
                        creado: new Date()
                    });
                }

                // Después de autenticación exitosa con Google
                showAlert('¡Autenticación con Google exitosa!', 'success');
                authForm.reset();
                hideAuthSection();
                window.location.href = "index.html"; // Redirige al dashboard
            } catch (error) {
                showAlert('No se pudo autenticar con Google. Intenta nuevamente.');
            }
        });

        // Monitorear estado de autenticación
        onAuthStateChanged(auth, (user) => {
            if (user) {
                // Usuario autenticado
                authButtons.classList.add('d-none');
                userInfo.classList.remove('d-none');
                userEmail.textContent = user.email;
                hideAuthSection();
            } else {
                // Usuario no autenticado
                authButtons.classList.remove('d-none');
                userInfo.classList.add('d-none');
                hideAuthSection();
            }
        });

        // Animación suave para los elementos
        window.addEventListener('scroll', () => {
            const elements = document.querySelectorAll('.feature-card');
            elements.forEach(element => {
                const elementTop = element.getBoundingClientRect().top;
                const elementVisible = 150;
                
                if (elementTop < window.innerHeight - elementVisible) {
                    element.style.opacity = '1';
                    element.style.transform = 'translateY(0)';
                }
            });
        });

        document.getElementById('resetPasswordForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const email = document.getElementById('resetEmail').value;
    const alertDiv = document.getElementById('resetPasswordAlert');
    try {
        await sendPasswordResetEmail(auth, email);
        alertDiv.innerHTML = `<div class="alert alert-success">Se ha enviado un enlace de recuperación a tu correo.</div>`;
    } catch (error) {
        alertDiv.innerHTML = `<div class="alert alert-danger">No se pudo enviar el correo de recuperación: ${error.message}</div>`;
    }
});

// Cambiar entre modo claro y oscuro
document.getElementById('toggleThemeBtn').addEventListener('click', () => {
    document.body.classList.toggle('dark-mode');
});
    </script>
</body>
</html>